
## üîß Distance Sensor Subsystem ‚Äì MPLAB Project Overview

This MPLAB X project implements the firmware for the distance sensor subsystem in our team‚Äôs UART-based communication network. It continuously reads simulated distance data and broadcasts key system state messages to other subsystems (Motor, OLED, and WiFi) using a standardized UART protocol.

### üì¶ Key Features

- **UART Messaging Protocol**  
  Each message follows the class-defined structure:  
  `[Prefix1] [Prefix2] [Sender] [Receiver] [Message Type] [Data...] [Suffix1] [Suffix2]`  
  All messages are 64 bytes in length and framed for reliability.

- **Subsystem Communication**  
  This subsystem transmits:
  - User distance data (`MSG_DISTANCE_DATA`) ‚Äì broadcast to all
  - Safety flag (`MSG_SAFETY_RESPONSE`) ‚Äì sent to Motor subsystem
  - Display flag (`MSG_OLED_FLAG`) ‚Äì sent to OLED subsystem
  - Machine use status (`MSG_MACHINE_STATUS`) ‚Äì sent to WiFi module

- **Timeout Handling & Message Trashing**  
  Messages from the subsystem itself or malformed data are discarded using timer interrupts.

- **Message Forwarding**  
  The subsystem forwards any UART messages not addressed to itself to maintain the daisy-chain topology.

- **Code Structure**  
  The main logic resides in `main.c` with UART handling and timed messaging built using MCC-generated peripheral drivers (EUSART1, Timer1).

### üìÅ Included Files

- `main.c` ‚Äì primary message logic
- `mcc_generated_files/` ‚Äì auto-generated by MPLAB Code Configurator (MCC)
- `system/` ‚Äì clock, interrupt, and initialization settings


# API
This table describes the messages sent from the distance sensor subsystem (Julia) using `uint8_t` binary flags (0 = False, 1 = True). All messages are formatted using the class UART protocol and occupy the data field (bytes 5‚Äì61) of the 64-byte message frame.


<h3 style="color:#e40303">Safety Response Message (to Motor)</h3>

This message tells the motor subsystem whether the user is currently in a safe position.

| Field           | Value |
|------------------|-------|
| **Byte 1** | `User_Safe_Flag` |
| **Variable Type** | `uint8_t` |
| **Min Value** | `0` (User Not Safe) |
| **Max Value** | `1` (User Safe) |
| **Example** | `1` |
| **Use** | Tells the motor whether to activate based on user position |


<h3 style="color:#ff8c00">OLED Display Message (to OLED)</h3>

This message instructs the OLED display what message to show based on user status.

| Field           | Value |
|------------------|-------|
| **Byte 1** | `OLED_Display_Flag` |
| **Variable Type** | `uint8_t` |
| **Min Value** | `0` (Display 'Stand on X') |
| **Max Value** | `1` (Display 'Initializing') |
| **Example** | `1` |
| **Use** | Tells the OLED whether to show initialization or waiting instructions |


<h3 style="color:#ffed00">Machine Use Status Message (to WiFi)</h3>

This message tells the WiFi module whether the machine is currently in use.

| Field           | Value |
|------------------|-------|
| **Byte 1** | `Machine_Use_Status` |
| **Variable Type** | `uint8_t` |
| **Min Value** | `0` (Idle) |
| **Max Value** | `1` (In Use) |
| **Example** | `1` |
| **Use** | Tells the WiFi module whether the machine is active |
